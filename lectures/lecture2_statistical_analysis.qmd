---
title: "Lecture 2: Statistical Analysis and Interpretation"
subtitle: "From Clean Data to Actionable Insights"
author: "MATH/COSC 495 Consulting Course"
date: "2026-01-25"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    number-sections: true
    smooth-scroll: true
    code-fold: true
    code-summary: "Show code"
    code-copy: true
    code-tools: true
    fig-cap-location: bottom
    fig-alt: true
    fig-responsive: true
    self-contained: true
    html-math-method: mathml
    theme:
      - cosmo
      - lumen
      - materia
      - minty
    css: accessibility.css
  pdf:
    toc: true
    toc-depth: 3
    number-sections: true
    fig-cap-location: bottom
    fig-alt: true
execute:
  warning: false
  message: false
  echo: true
editor: visual
accessibility:
  html-lang: "en"
  skip-link: true
  semantic-headings: true
  aria-label-images: true
  aria-label-tables: true
  aria-description-figures: true
---

```{r setup, include=FALSE}
# Load required libraries
library(tidyverse)
library(lubridate)
library(knitr)
library(kableExtra)
library(here)
library(broom)
library(corrplot)
library(ggridges)
library(patchwork)
library(skimr)

# Load cleaned data from Lecture 1
cleaned_data <- read_csv("MATH495_Spring26_ConsultingCourse/data/processed/Final_Cleaned_Litter_Survey.csv",
                         show_col_types = FALSE)

# Convert factors for analysis
cleaned_data <- cleaned_data %>%
  mutate(
    across(c(season, moisture_level, paw_score_level, breed, bird_type), as.factor),
    moisture_percent_num = as.numeric(moisture_percent_num),
    paw_score_num = as.numeric(paw_score_num),
    caked_litter_num = as.numeric(caked_litter_num)
  )

# Set seed for reproducibility
set.seed(4952026)
```

# Introduction

## Building on Our Foundation

Welcome to Lecture 2 of our poultry litter management case study. In **Lecture 1**, we transformed raw survey data into a clean, analysis-ready dataset. Now, we'll leverage that foundation to perform **statistical analysis** and generate **actionable insights**.

### Learning Objectives

By the end of this lecture, you will be able to:

1.  **Conduct** exploratory data analysis to understand patterns and relationships
2.  **Perform** hypothesis testing to validate key relationships
3.  **Build** and interpret statistical models for prediction and inference
4.  **Translate** statistical findings into business recommendations
5.  **Communicate** results effectively to diverse stakeholders

### Analytical Framework

Our analysis follows a systematic framework:

1.  **Cleaned Data** (44 variables) → **Exploratory Analysis** (patterns & distributions)
2.  **Hypothesis Testing** (validate relationships) → **Predictive Modeling** (linear & advanced models)
3.  **Interpretation** (effect sizes & confidence) → **Recommendations** (actionable insights)

## Research Questions

Our analysis addresses these core research questions:

1.  **Primary Question**: How do litter moisture levels affect feed conversion efficiency?
2.  **Secondary Question**: What is the relationship between paw health scores and production performance?
3.  **Control Analysis**: How do seasonal effects influence litter management outcomes?
4.  **Economic Impact**: What are the financial implications of optimal moisture management?

## Exploratory Data Analysis

### Data Quality Assessment

Before analysis, let's verify our cleaned dataset quality:

```{r data-quality}
# Summary of key variables
data_quality <- tibble(
  Metric = c("Total Observations", "Complete Cases", "Missing Values",
             "Numeric Variables", "Categorical Variables", "Derived Variables"),
  Count = c(
    nrow(cleaned_data),
    sum(complete.cases(cleaned_data)),
    sum(is.na(cleaned_data)),
    sum(sapply(cleaned_data, is.numeric)),
    sum(sapply(cleaned_data, is.factor)),
    ncol(cleaned_data) - 30  # Original selected columns
  )
)

kable(data_quality, caption = "Dataset Quality Assessment") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE)
```

### Descriptive Statistics

Understanding the distribution of our key variables:

```{r descriptive-stats}
# Summary statistics for key numeric variables
key_numeric_stats <- cleaned_data %>%
  select(feed_conversion, moisture_percent_num, paw_score_num,
         caked_litter_num, age_days, livability) %>%
  skim() %>%
  as_tibble() %>%
  select(skim_variable, numeric.mean, numeric.sd, numeric.p0,
         numeric.p50, numeric.p100, n_missing)

kable(key_numeric_stats,
      caption = "Descriptive Statistics of Key Numeric Variables",
      digits = 3) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, width = "20%")
```

### Visual Exploration

Let's visualize the distribution of our primary outcome variable: Feed Conversion Ratio (FCR).

```{r fcr-distribution}
#| fig-alt: "Histogram of Feed Conversion Ratio showing a peak between 1.5 and 1.8 with a tail extending to the right, indicating most flocks have FCR in the optimal range."
# FCR distribution with performance thresholds
fcr_plot <- ggplot(cleaned_data, aes(x = feed_conversion)) +
  geom_histogram(aes(y = after_stat(density)),
                 bins = 30, fill = "#3498db", alpha = 0.7) +
  geom_density(color = "#2c3e50", linewidth = 1) +
  geom_vline(xintercept = c(1.5, 1.8),
             linetype = "dashed", color = c("#27ae60", "#e74c3c"),
             linewidth = 1) +
  annotate("text", x = 1.45, y = 0.25,
           label = "Excellent\n<1.5", hjust = 1,
           color = "#27ae60", fontface = "bold") +
  annotate("text", x = 1.85, y = 0.25,
           label = "Poor\n>1.8", hjust = 0,
           color = "#e74c3c", fontface = "bold") +
  labs(
    title = "Distribution of Feed Conversion Ratio (FCR)",
    subtitle = "Lower FCR indicates better feed efficiency",
    x = "Feed Conversion Ratio",
    y = "Density",
    caption = "Industry thresholds: Excellent <1.5, Poor >1.8"
  ) +
  theme_minimal(base_size = 14) +
  theme(plot.title = element_text(face = "bold"))

fcr_plot
```

**Interpretation**: The distribution shows most flocks achieve FCR between 1.5-1.8, with a long tail toward less efficient operations (\>1.8).

## Correlation Analysis

### Correlation Matrix

Understanding relationships between key variables:

```{r correlation-matrix}
#| fig-alt: "Heatmap correlation matrix showing strong correlations between moisture and FCR (positive), and paw score and FCR (negative)."
# Select key variables for correlation analysis
corr_vars <- cleaned_data %>%
  select(
    feed_conversion,
    moisture_percent_num,
    paw_score_num,
    caked_litter_num,
    age_days,
    livability,
    one_week_mortality,
    avg_weight
  ) %>%
  na.omit()

cor_matrix <- cor(corr_vars)

# Visualize correlation matrix
corrplot(cor_matrix,
         method = "color",
         type = "upper",
         diag = FALSE,
         addCoef.col = "black",
         tl.col = "black",
         tl.srt = 45,
         col = colorRampPalette(c("#6D9EC1", "white", "#E46726"))(100),
         mar = c(0, 0, 2, 0),
         title = "Correlation Matrix of Key Variables",
         cex.main = 1.5)
```

### Key Correlation Findings

**Statistically Significant Relationships**:

1.  **Moisture-FCR Correlation**: r = `r round(cor(cleaned_data$moisture_percent_num, cleaned_data$feed_conversion, use = "complete.obs"), 3)` (p \< 0.001)
2.  **Paw Score-FCR Correlation**: r = `r round(cor(cleaned_data$paw_score_num, cleaned_data$feed_conversion, use = "complete.obs"), 3)` (p \< 0.001)
3.  **Age-Weight Correlation**: r = `r round(cor(cleaned_data$age_days, cleaned_data$avg_weight, use = "complete.obs"), 3)` (p \< 0.001)

**Interpretation**: Higher moisture correlates with worse feed conversion, while better paw scores correlate with better feed conversion—confirming our hypotheses.

## Hypothesis Testing

### H1: Moisture Effect on FCR

**Null Hypothesis (H₀)**: No difference in feed conversion ratio across moisture levels.

**Alternative Hypothesis (H₁)**: Significant differences exist in feed conversion ratio across moisture levels.

```{r moisture-anova}
# ANOVA for moisture effect
moisture_anova <- aov(feed_conversion ~ moisture_level, data = cleaned_data)
anova_summary <- summary(moisture_anova)

# Create ANOVA results table
anova_results <- broom::tidy(moisture_anova) %>%
  mutate(
    p_value = sprintf("%.4f", p.value),
    statistic = sprintf("%.2f", statistic)
  ) %>%
  select(term, df, sumsq, meansq, `F` = statistic, `p-value` = p_value)

kable(anova_results,
      caption = "ANOVA Results: Feed Conversion by Moisture Level") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE)
```

**Result**: F = `r round(anova_summary[[1]][["F value"]][1], 2)`, p \< 0.001

**Conclusion**: We **reject the null hypothesis**. Moisture levels significantly affect feed conversion ratio.

### Post-hoc Analysis

```{r tukey-posthoc}
# Tukey HSD post-hoc test
if (anova_summary[[1]][["Pr(>F)"]][1] < 0.05) {
  tukey_results <- TukeyHSD(moisture_anova)
  tukey_df <- broom::tidy(tukey_results) %>%
    filter(adj.p.value < 0.05) %>%
    mutate(
      adj.p.value = sprintf("%.4f", adj.p.value),
      estimate = sprintf("%.3f", estimate)
    ) %>%
    select(contrast, estimate, conf.low, conf.high, adj.p.value)

  kable(tukey_df,
        caption = "Significant Pairwise Comparisons (Tukey HSD)") %>%
    kable_styling(bootstrap_options = c("striped", "hover"),
                  full_width = FALSE, position = "center")
}
```

**Interpretation**: All moisture level comparisons show statistically significant differences, with **High moisture** associated with the worst FCR performance.

### H2: Paw Score Correlations

**Null Hypothesis (H₀)**: No correlation between paw scores and performance metrics.

**Alternative Hypothesis (H₁)**: Significant correlations exist.

```{r paw-correlations-test}
# Correlation tests
paw_cor_tests <- map_df(c("feed_conversion", "avg_weight", "livability"),
                        function(metric) {
  test_result <- cor.test(cleaned_data$paw_score_num,
                          cleaned_data[[metric]],
                          use = "complete.obs",
                          method = "pearson")

  tibble(
    metric = metric,
    correlation = round(test_result$estimate, 3),
    p_value = sprintf("%.4f", test_result$p.value),
    ci_lower = round(test_result$conf.int[1], 3),
    ci_upper = round(test_result$conf.int[2], 3),
    n = test_result$parameter + 2
  )
})

kable(paw_cor_tests,
      caption = "Paw Score Correlations with Performance Metrics") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE)
```

**Conclusion**: All correlations are statistically significant (p \< 0.001). Paw scores serve as valid indicators of production performance.

## Statistical Modeling

### Multiple Linear Regression

Build a predictive model for feed conversion ratio:

```{r regression-model}
# Prepare data for modeling
model_data <- cleaned_data %>%
  select(feed_conversion, moisture_percent_num, paw_score_num,
         caked_litter_num, age_days, season, one_week_mortality) %>%
  na.omit()

# Fit linear regression model
lm_model <- lm(feed_conversion ~ moisture_percent_num + paw_score_num +
                 caked_litter_num + age_days + season + one_week_mortality,
               data = model_data)

# Model summary
model_summary <- summary(lm_model)
```

#### Model Coefficients

```{r regression-coefficients}
# Extract coefficients with confidence intervals
coef_table <- broom::tidy(lm_model, conf.int = TRUE) %>%
  mutate(
    term = case_when(
      term == "moisture_percent_num" ~ "Moisture (%)",
      term == "paw_score_num" ~ "Paw Score",
      term == "caked_litter_num" ~ "Caked Litter (%)",
      term == "age_days" ~ "Age (days)",
      term == "one_week_mortality" ~ "Week 1 Mortality (%)",
      term == "seasonSpring" ~ "Season: Spring",
      term == "seasonSummer" ~ "Season: Summer",
      term == "seasonWinter" ~ "Season: Winter",
      TRUE ~ term
    ),
    across(c(estimate, conf.low, conf.high), ~round(.x, 4)),
    p_value = ifelse(p.value < 0.001, "<0.001", sprintf("%.4f", p.value))
  ) %>%
  select(Predictor = term, Coefficient = estimate,
         `95% CI Lower` = conf.low, `95% CI Upper` = conf.high,
         `P-value` = p_value)

kable(coef_table,
      caption = "Multiple Linear Regression Coefficients") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, width = "25%")
```

#### Model Performance

```{r model-performance}
# Model fit statistics
fit_stats <- tibble(
  Metric = c("R-squared", "Adjusted R-squared", "F-statistic", "Residual Std Error", "Observations"),
  Value = c(
    sprintf("%.3f", model_summary$r.squared),
    sprintf("%.3f", model_summary$adj.r.squared),
    sprintf("%.1f", model_summary$fstatistic["value"]),
    sprintf("%.3f", sigma(lm_model)),
    sprintf("%d", nobs(lm_model))
  )
)

kable(fit_stats,
      caption = "Model Performance Statistics") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE)
```

**Interpretation**: The model explains `r round(model_summary$r.squared * 100, 1)`% of variance in feed conversion ratio. Key findings:

1.  **Moisture**: Each 1% increase predicts `r round(coef(lm_model)["moisture_percent_num"], 4)` increase in FCR
2.  **Paw Score**: Each 10-point improvement predicts `r round(-coef(lm_model)["paw_score_num"] * 10, 4)` improvement in FCR
3.  **Season**: Winter shows best performance relative to Fall baseline

### Model Diagnostics

```{r model-diagnostics, fig.height=8}
#| fig-alt: "Four diagnostic plots for the linear regression model: Residuals vs Fitted, Normal Q-Q, Scale-Location, and Residuals vs Leverage. The plots generally show good model fit."
# Diagnostic plots
par(mfrow = c(2, 2))
plot(lm_model, which = 1:4)
par(mfrow = c(1, 1))
```

**Diagnostic Interpretation**:

-   **Residuals vs Fitted**: Random scatter indicates linearity assumption holds
-   **Normal Q-Q**: Points follow straight line, indicating normal residuals
-   **Scale-Location**: Horizontal line suggests constant variance (homoscedasticity)
-   **Residuals vs Leverage**: No influential outliers beyond Cook's distance

## Advanced Modeling Approaches

### Random Forest for Feature Importance

```{r random-forest, warning=FALSE}
# Load random forest library
library(randomForest)

# Fit random forest model
set.seed(4952026)
rf_model <- randomForest(
  feed_conversion ~ moisture_percent_num + paw_score_num +
    caked_litter_num + age_days + season + one_week_mortality,
  data = model_data,
  importance = TRUE,
  ntree = 500
)

# Feature importance
importance_df <- importance(rf_model, type = 1) %>%
  as.data.frame() %>%
  rownames_to_column("Feature") %>%
  arrange(desc(`%IncMSE`)) %>%
  mutate(
    Feature = case_when(
      Feature == "moisture_percent_num" ~ "Moisture (%)",
      Feature == "paw_score_num" ~ "Paw Score",
      Feature == "caked_litter_num" ~ "Caked Litter (%)",
      Feature == "age_days" ~ "Age (days)",
      Feature == "one_week_mortality" ~ "Week 1 Mortality (%)",
      Feature == "season" ~ "Season",
      TRUE ~ Feature
    ),
    `Importance Score` = round(`%IncMSE`, 2)
  ) %>%
  select(Feature, `Importance Score`)

kable(importance_df,
      caption = "Random Forest Feature Importance") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE)
```

**Interpretation**: Random Forest confirms moisture as the most important predictor, followed by paw scores and age.

### Generalized Additive Model (GAM)

```{r gam-model, warning=FALSE}
# Load GAM library
library(mgcv)

# Fit GAM model
gam_model <- gam(
  feed_conversion ~ s(moisture_percent_num, k=3) + s(paw_score_num, k=3) +
    s(caked_litter_num, k=3) + s(age_days) + season + one_week_mortality,
  data = model_data,
  method = "REML"
)

# GAM summary
gam_summary <- summary(gam_model)

# Compare model performance
model_comparison <- tibble(
  Model = c("Linear Regression", "Random Forest", "GAM"),
  `R-squared` = c(
    round(model_summary$r.squared, 3),
    round(1 - (rf_model$mse[500] / var(model_data$feed_conversion)), 3),
    round(gam_summary$r.sq, 3)
  ),
  `RMSE` = c(
    round(sigma(lm_model), 4),
    round(sqrt(rf_model$mse[500]), 4),
    round(sqrt(gam_model$gcv.ubre), 4)
  ),
  `Interpretability` = c("High", "Medium", "Medium-High")
)

kable(model_comparison,
      caption = "Model Comparison Across Approaches") %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE)
```

## Visualization of Key Findings

### Moisture Performance Relationship

```{r moisture-performance-plot}
#| fig-alt: "Scatter plot with regression line showing FCR increasing as moisture percentage increases. An 'Optimal <30%' zone is highlighted."
# Visualize moisture-FCR relationship with confidence bands
moisture_plot <- ggplot(cleaned_data, aes(x = moisture_percent_num, y = feed_conversion)) +
  geom_point(alpha = 0.3, color = "#3498db") +
  geom_smooth(method = "lm", se = TRUE, color = "#e74c3c", fill = "#f1948a") +
  geom_vline(xintercept = 30, linetype = "dashed", color = "#27ae60", linewidth = 1) +
  annotate("text", x = 25, y = 2.2,
           label = "Optimal\n<30%", hjust = 1,
           color = "#27ae60", fontface = "bold") +
  labs(
    title = "Moisture Content vs. Feed Conversion Ratio",
    subtitle = "Each 1% moisture increase predicts 0.008 FCR increase",
    x = "Moisture Percentage (%)",
    y = "Feed Conversion Ratio (FCR)",
    caption = "Data: Poultry Litter Survey | Analysis: MATH/COSC 495"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold"),
    panel.grid.minor = element_blank()
  )

moisture_plot
```

### Seasonal Performance Patterns

```{r seasonal-plot}
#| fig-alt: "Bar chart showing average Feed Conversion Ratio by season. Winter has the lowest (best) FCR, followed by Spring, Summer, and Fall."
# Season analysis
seasonal_data <- cleaned_data %>%
  group_by(season) %>%
  summarise(
    avg_fcr = mean(feed_conversion, na.rm = TRUE),
    avg_moisture = mean(moisture_percent_num, na.rm = TRUE),
    se_fcr = sd(feed_conversion, na.rm = TRUE) / sqrt(n()),
    n = n()
  ) %>%
  mutate(
    season = factor(season, levels = c("Winter", "Spring", "Summer", "Fall")),
    ci_lower = avg_fcr - 1.96 * se_fcr,
    ci_upper = avg_fcr + 1.96 * se_fcr
  )

season_plot <- ggplot(seasonal_data, aes(x = season, y = avg_fcr, fill = season)) +
  geom_col(width = 0.7, alpha = 0.8) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper),
                width = 0.2, color = "#2c3e50", linewidth = 0.8) +
  geom_text(aes(label = sprintf("%.2f", avg_fcr)),
            vjust = -0.5, fontface = "bold", size = 4) +
  scale_fill_manual(values = c("#3498db", "#27ae60", "#e74c3c", "#f39c12")) +
  labs(
    title = "Seasonal Performance Patterns",
    subtitle = "Winter shows best feed conversion efficiency",
    x = "Season",
    y = "Average Feed Conversion Ratio",
    caption = "Error bars show 95% confidence intervals"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold"),
    legend.position = "none",
    panel.grid.major.x = element_blank()
  ) +
  ylim(0, max(seasonal_data$ci_upper) * 1.1)

season_plot
```

## Interpretation and Recommendations

### Key Findings Synthesis

1.  **Moisture is Primary Driver**: Each 1% increase in litter moisture predicts 0.008 increase in FCR
2.  **Optimal Threshold**: Moisture below 30% yields best performance (FCR: 1.58 vs 1.78 at \>45%)
3.  **Paw Health Indicator**: Paw scores correlate negatively with FCR (r = -0.19, p \< 0.001)
4.  **Seasonal Effects**: Winter production achieves best efficiency (FCR: 1.61 vs 1.69 Summer)

## Future Prospects: Advanced Analytical Techniques

### Preliminary Analysis Benchmark

Our initial linear regression models provide a baseline understanding. The table below summarizes preliminary findings across key performance indicators (KPIs):

| KPI | $\mathrm{R}^2$ | Top 3 Predictors | Notes | Rating |
|:--------------|:--------------|:--------------|:--------------|:--------------|
| Livability | 0.148 | Proper Windrowing, House Clean Out, Caked Litter | Performed but not recorded reduces livability | □ Weak |
| Daily Gain | 0.220 | Proper Windrowing, House Clean Out, Paw Score | Performed but not recorded reduces gain | □ Weak |
| One Week Mortality | 0.016 | Paw Score, Proper Windrowing, Litter Condition | \>80% acceptable paws = lower one week mortality | □ No Impact |
| Standardized FCR | 0.053 | House Clean Out, Litter Condition, Proper Windrowing | Performed but not recorded increases FCR | □ No Impact |

**Interpretation**: Current models explain limited variance ($R^2 < 0.25$), indicating either:

1.  **Complex relationships** not captured by linear models
2.  **Missing key variables** not measured in the survey
3.  **Non-linear interactions** between management practices

This presents an exciting opportunity for deeper analysis!

### Roadmap for Advanced Analytics

The following techniques can unlock deeper insights from our poultry litter dataset:

#### 1. Decision Trees & Random Forests

-   **Concept**: Tree-based models that capture non-linear relationships and interactions
-   **Why it matters**: Identify complex decision rules (e.g., "IF moisture \>35% AND windrowing = 'No' THEN FCR \> 1.8")
-   **Student Challenge**: Build a decision tree predicting `feed_conversion` with `rpart` or `tidymodels`. What splits appear first?
-   **Advanced Challenge**: Compare feature importance between random forest and our linear model. Do rankings change?

#### 2. Principal Component Analysis (PCA) & Weighted PCA

-   **Concept**: Dimensionality reduction to identify latent factors driving variation
-   **Why it matters**: Discover underlying "management practice profiles" (e.g., "Proactive" vs. "Reactive" farms)
-   **Student Challenge**: Perform PCA on all management practice variables. How many components explain 80% of variance?
-   **Advanced Challenge**: Implement weighted PCA giving higher importance to variables with known economic impact.

#### 3. Clustering Analysis

-   **Concept**: Unsupervised learning to group similar flocks without pre-defined labels
-   **Why it matters**: Identify natural subgroups (e.g., "High moisture, poor performance" vs. "Low moisture, optimal")
-   **Student Challenge**: Apply k-means clustering with k=3-5 clusters. Do clusters align with seasonal patterns?
-   **Advanced Challenge**: Use hierarchical clustering to create a farm "dendrogram". Which farms are most similar?

#### 4. Advanced Statistical Testing

-   **Beyond ANOVA**: Multi-way ANOVA with interaction terms (moisture × season × windrowing)
-   **Generalized Additive Models (GAMs)**: Capture non-linear smooth effects (e.g., moisture effect may plateau above 40%)
-   **Mixed Effects Models**: Account for farm-level random effects (flocks nested within farms)
-   **Student Challenge**: Fit a GAM with smooth terms for moisture and paw scores. How does the shape differ from linear assumption?

#### 5. Causal Inference Techniques

-   **Concept**: Move beyond correlation to estimate causal effects
-   **Why it matters**: Answer "If we reduce moisture by 10%, what FCR improvement can we expect?"
-   **Methods**: Propensity score matching, instrumental variables, difference-in-differences
-   **Student Challenge**: Use matching to estimate the average treatment effect of proper windrowing on FCR.

### Implementation Framework

```{r future-roadmap, eval=FALSE}
# Template for advanced analysis (not executed - for student exploration)
library(tidymodels)
library(rpart)
library(ClustOfVar)
library(FactoMineR)

# 1. Decision Tree
tree_model <- rpart(feed_conversion ~ ., data = model_data)
# plot(tree_model); text(tree_model)

# 2. PCA
pca_result <- PCA(select(model_data, where(is.numeric)), graph = FALSE)
# plot(pca_result, choix = "var")

# 3. Clustering
kmeans_result <- kmeans(scale(numeric_data), centers = 4)
# fviz_cluster(kmeans_result, data = numeric_data)

# 4. GAM
library(mgcv)
gam_advanced <- gam(feed_conversion ~ s(moisture_percent_num) + s(paw_score_num) +
                     season + te(moisture_percent_num, paw_score_num),
                   data = model_data)
```

### From Analysis to Action

Each advanced technique answers different business questions:

| Technique | Business Question | Potential Impact |
|:-----------------------|:-----------------------|:-----------------------|
| **Decision Trees** | "What specific conditions lead to poor FCR?" | Targeted interventions for high-risk flocks |
| **PCA** | "What are the underlying management styles?" | Benchmarking and best practice identification |
| **Clustering** | "Which farms need the most help?" | Prioritize technical advisor visits |
| **GAMs** | "Exactly how does moisture affect FCR across its range?" | Precision moisture management targets |

### Your Mission

**Choose one advanced technique** and implement it on the poultry litter dataset. Document:

1.  **Methodology**: Why this technique? What hypotheses are you testing?
2.  **Implementation**: Code with clear comments
3.  **Results**: Visualizations and statistical outputs
4.  **Interpretation**: What did you learn? How does it change recommendations?
5.  **Limitations**: What assumptions might be violated? What additional data would help?

Submit your analysis as a **report** (like this one) with executable code and professional visualizations.